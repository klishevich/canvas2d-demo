<!DOCTYPE html>
<html>
<body>
	<canvas id="canvas" width="300" height="300"></canvas>

  <script type="text/javascript">

    function draw() {
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');

      ctx.save();

      const width = 200;
      const height = 100;

      // draw grey rect, not rotated
      ctx.fillStyle = '#4D4E5366';
      ctx.fillRect(0, 0, width, height);

      // draw rotated
      const rotation = 45;
      const rotationRad = (rotation * Math.PI) / 180;
      const newWidth = width * Math.abs(Math.cos(rotationRad)) + height * Math.abs(Math.sin(rotationRad));
      console.log("newWidth", newWidth);
      const newHeight = width * Math.abs(Math.sin(rotationRad)) + height * Math.abs(Math.cos(rotationRad));
      console.log("newHeight", newHeight);
      const deltaWidth = width * (Math.cos(rotationRad) - 1) + height * Math.sin(rotationRad);
      const deltaHeight = height * (Math.cos(rotationRad) - 1) + width * Math.sin(rotationRad);

      ctx.translate(newWidth/2, newHeight/2);
      ctx.rotate((Math.PI / 180) * rotation);
      ctx.translate(-width/2, -height/2);
      // ctx.translate(-newWidth/2, -newHeight/2); // translate back

      ctx.fillStyle = '#0095DD66';
      ctx.fillRect(0, 0, width, height);
      ctx.fillStyle = "red";
      ctx.font = "bold 18px serif";
      ctx.fillText("text text text text text", 20, 20);


      ctx.restore();
    }
    draw();
  </script>
</body>
</html>
